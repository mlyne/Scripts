#!/usr/bin/perl -slw
use strict;

my @logfact = <DATA>;

sub hypergeom {
    # There are m "bad" and n "good" balls in an urn.
    # Pick N of them. The probability of i or more successful selections:
    # (m!n!N!(m+n-N)!)/(i!(n-i)!(m+i-N)!(N-i)!(m+n)!)
    my ($n, $m, $N, $i) = @_;

    my $loghyp1 = $logfact[ $m ] + $logfact[ $n ]
                + $logfact[ $N ] + $logfact[ $m + $n - $N ];
    my $loghyp2 = $logfact[ $i ] + $logfact[ $n - $i ] 
                + $logfact[ $m + $i - $N ] + $logfact[ $N - $i ] 
                + $logfact[ $m + $n ];

    return exp($loghyp1 - $loghyp2);
}

print hypergeom( 300, 700, 100, 40 );


__DATA__
0
-4.44089209850063e-016
0.693147180559944
1.79175946922805
3.17805383034795
4.78749174278204
6.57925121201012
8.5251613610655
10.6046029027455
12.801827480082
15.1044125730764
17.5023078458753
19.987214495664
22.5521638531263
25.1912211827425
27.8992713838458
30.6718601060867
33.5050734501442
36.3954452080417
39.3398841872096
42.3356164607651
45.3801388984901
48.47118135185
51.6066755677807
54.7847293981303
58.0036052230002
61.2617017610234
64.5575386270294
67.8897431372063
71.2570389671945
74.6582363488584
78.0922235533452
81.5579594561467
85.0544670176148
88.5808275422327
92.1361756037237
95.7196945421815
99.3306124548273
102.968198614555
106.631760260687
110.320639714802
114.034211781508
117.771881399793
121.533081515488
125.317271149408
129.123933639179
132.95257503567
136.802722637381
140.673923648291
144.565743946403
148.477766951832
152.409592584558
156.36083630314
160.331128216694
164.320112263259
168.327445448493
172.352797139229
176.395848407065
180.456291417613
184.53382886152
188.628173423743
192.739047287917
196.866181672964
201.009316399356
205.168199482717
209.342586752614
213.532241494641
217.736934114033
221.95644181921
226.190548323808
230.439043565859
234.701723442901
238.978389561918
243.268849003067
247.572914096272
251.89040220981
256.221135550097
260.564940971951
264.921649798642
269.29109765111
273.673124285784
278.067573440458
282.474292687723
286.89313329552
291.323950094364
295.766601350855
300.220948647109
304.686856765765
309.164193580244
313.652829949977
318.152639620308
322.663499126825
327.185287703875
331.717887197029
336.261181979299
340.815058870901
345.379407062369
349.954118040873
354.539085519544
359.13420536968
363.739375555668
368.35449607251
372.979468885795
377.614197874025
382.258588773167
386.912549123325
391.575988217438
396.2488170519
400.930948279025
405.622296161255
410.322776527048
415.032306728361
419.750805599656
424.478193418369
429.214391866764
433.959323995128
438.712914186235
443.475088121033
448.245772745499
453.024896238611
457.812387981394
462.608178526991
467.412199571725
472.224383927098
477.044665492703
481.872979230006
486.709261136958
491.553448223417
496.405478487337
501.265290891699
506.132825342155
511.008022665356
515.890824587943
520.781173716165
525.679013516117
530.584288294556
535.496943180292
540.41692410612
545.344177791278
550.278651724409
555.220294147019
560.169054037397
565.124881094999
570.087725725259
575.057539024836
580.034272767256
585.017879388965
590.008311975744
595.005524249509
600.009470555455
605.020105849551
610.037385686366
615.061266207213
620.091704128606
625.12865673102
630.172081847939
635.221937855189
640.278183660538
645.340778693565
650.409682895786
655.48485671102
660.566261076004
665.653857411237
670.747607612044
675.847474039869
680.95341951377
686.065407302126
691.183401114543
696.307365093947
701.43726380887
706.573062245921
711.714725802424
716.862220279237
722.015511873736
727.17456717295
732.339353146874
737.509837141913
742.685986874487
747.867770424779
753.05515623062
758.248113081511
763.446610112777
768.650616799854
773.860102952695
779.075038710304
784.295394535383
789.521141209097
794.752249825951
799.988691788781
805.230438803841
810.477462876002
815.729736304049
820.987231676077
826.249921864982
831.517780024046
836.79077958261
842.06889424184
847.352097970579
852.640365001273
857.933669825998
863.231987192546
868.535292100606
873.843559798007
879.156765777049
884.474885770893
889.797895750032
895.125771918822
900.458490712087
905.796028791789
911.138363043754
916.485470574471
921.837328707948
927.19391498262
932.555207148329
937.921183163351
943.291821191479
948.667099599164
954.046996952704
959.431492015494
964.82056374531
970.214191291663
975.612353993181
981.015031375053
986.422203146514
991.833849198369
997.249949600573
1002.67048459985
1008.09543461733
1013.52478024628
1018.95850224984
1024.39658155876
1029.83899926928
1035.28573664095
1040.73677509451
1046.19209620987
1051.65168172402
1057.11551352904
1062.58357367018
1068.05584434385
1073.53230789578
1079.01294681912
1084.49774375261
1089.98668147877
1095.47974292211
1100.9769111474
1106.47816935795
1111.98350089388
1117.49288923051
1123.00631797668
1128.52377087314
1134.045231791
1139.57068473013
1145.10011381765
1150.63350330637
1156.17083757339
1161.71210111855
1167.25727856303
1172.80635464793
1178.35931423285
1183.91614229455
1189.47682392556
1195.04134433289
1200.60968883665
1206.18184286882
1211.75779197197
1217.33752179796
1222.92101810674
1228.50826676514
1234.09925374565
1239.69396512525
1245.29238708425
1250.89450590513
1256.50030797143
1262.10977976661
1267.722907873
1273.33967897067
1278.96007983638
1284.58409734257
1290.21171845626
1295.84293023808
1301.47771984125
1307.11607451059
1312.75798158153
1318.40342847917
1324.05240271733
1329.7048918976
1335.36088370842
1341.02036592418
1346.68332640431
1352.34975309243
1358.01963401541
1363.69295728258
1369.36971108485
1375.04988369387
1380.7334634612
1386.42043881754
1392.11079827187
1397.80453041067
1403.50162389718
1409.20206747057
1414.90584994522
1420.61296020997
1426.32338722735
1432.03712003286
1437.75414773426
1443.47445951087
1449.19804461282
1454.92489236041
1460.65499214338
1466.38833342028
1472.12490571776
1477.86469862994
1483.60770181775
1489.35390500829
1495.1032979942
1500.85587063302
1506.61161284661
1512.37051462049
1518.13256600327
1523.89775710605
1529.66607810185
1535.43751922498
1541.21207077052
1546.98972309375
1552.77046660954
1558.55429179187
1564.34118917323
1570.13114934413
1575.92416295252
1581.72022070328
1587.51931335774
1593.32143173312
1599.12656670204
1604.93470919202
1610.74585018499
1616.55998071682
1622.37709187678
1628.19717480713
1634.02022070262
1639.84622081
1645.67516642761
1651.50704890489
1657.34185964195
1663.17959008912
1669.02023174649
1674.86377616353
1680.71021493858
1686.55953971853
1692.4117421983
1698.26681412051
1704.12474727499
1709.98553349846
1715.84916467405
1721.71563273099
1727.58492964412
1733.4570474336
1739.33197816445
1745.20971394623
1751.09024693263
1756.97356932112
1762.85967335257
1768.7485513109
1774.64019552273
1780.53459835699
1786.43175222463
1792.33164957821
1798.23428291161
1804.13964475967
1810.04772769784
1815.95852434188
1821.87202734752
1827.78822941012
1833.7071232644
1839.62870168404
1845.55295748145
1851.47988350743
1857.40947265081
1863.34171783826
1869.27661203388
1875.21414823897
1881.15431949169
1887.09711886681
1893.04253947542
1898.9905744646
1904.94121701719
1910.89446035148
1916.85029772094
1922.80872241397
1928.76972775359
1934.73330709721
1940.69945383634
1946.66816139632
1952.63942323611
1958.61323284798
1964.58958375728
1970.56846952218
1976.54988373344
1982.53382001412
1988.52027201941
1994.5092334363
2000.50069798341
2006.49465941071
2012.49111149933
2018.49004806128
2024.49146293924
2030.49535000635
2036.50170316595
2042.51051635139
2048.52178352579
2054.53549868184
2060.55165584154
2066.57024905603
2072.59127240538
2078.61471999834
2084.64058597217
2090.6688644924
2096.69954975266
2102.73263597446
2108.76811740698
2114.80598832691
2120.84624303818
2126.88887587186
2132.9338811859
2138.98125336495
2145.03098682018
2151.0830759891
2157.13751533537
2163.1942993486
2169.25342254418
2175.31487946311
2181.3786646718
2187.4447727619
2193.51319835015
2199.58393607815
2205.65698061225
2211.73232664334
2217.80996888669
2223.88990208178
2229.97212099216
2236.05662040524
2242.14339513215
2248.2324400076
2254.32374988967
2260.41731965972
2266.51314422215
2272.61121850432
2278.71153745634
2284.81409605095
2290.91888928337
2297.02591217111
2303.13515975387
2309.24662709337
2315.36030927321
2321.47620139869
2327.59429859673
2333.71459601568
2339.8370888252
2345.96177221609
2352.08864140021
2358.21769161027
2364.34891809975
2370.48231614275
2376.61788103383
2382.75560808791
2388.89549264014
2395.03753004573
2401.18171567985
2407.32804493752
2413.47651323344
2419.62711600189
2425.77984869659
2431.93470679061
2438.09168577619
2444.25078116468
2450.41198848638
2456.57530329041
2462.74072114465
2468.90823763553
2475.07784836803
2481.24954896544
2487.42333506934
2493.59920233944
2499.7771464535
2505.95716310715
2512.13924801386
2518.3233969048
2524.5096055287
2530.69786965179
2536.88818505764
2543.08054754711
2549.27495293822
2555.47139706601
2561.6698757825
2567.87038495655
2574.07292047374
2580.2774782363
2586.48405416303
2592.69264418913
2598.90324426615
2605.1158503619
2611.33045846032
2617.54706456141
2623.7656646811
2629.9862548512
2636.20883111927
2642.43338954855
2648.65992621784
2654.88843722143
2661.118918669
2667.35136668556
2673.58577741127
2679.82214700148
2686.06047162652
2692.30074747169
2698.54297073714
2704.78713763781
2711.03324440329
2717.2812872778
2723.53126252006
2729.78316640322
2736.0369952148
2742.29274525655
2748.55041284443
2754.8099943085
2761.07148599282
2767.33488425541
2773.60018546815
2779.86738601669
2786.1364823004
2792.40747073226
2798.6803477388
2804.95510976004
2811.23175324939
2817.51027467355
2823.79067051251
2830.07293725941
2836.35707142048
2842.64306951499
2848.93092807515
2855.22064364606
2861.51221278562
2867.80563206446
2874.1008980659
2880.39800738584
2886.69695663269
2892.99774242736
2899.3003614031
2905.60481020552
2911.91108549247
2918.21918393398
2924.52910221221
2930.84083702136
2937.15438506764
2943.46974306916
2949.78690775591
2956.10587586965
2962.4266441639
2968.74920940383
2975.07356836621
2981.39971783937
2987.7276546231
2994.05737552862
3000.38887737851
3006.72215700665
3013.05721125815
3019.3940369893
3025.7326310675
3032.07299037123
3038.41511178995
3044.75899222408
3051.10462858491
3057.45201779456
3063.80115678594
3070.15204250266
3076.50467189898
3082.85904193977
3089.21514960047
3095.57299186698
3101.93256573565
3108.29386821322
3114.65689631676
3121.02164707361
3127.38811752135
3133.7563047077
3140.12620569052
3146.49781753776
3152.87113732733
3159.24616214716
3165.62288909506
3172.00131527871
3178.38143781561
3184.76325383302
3191.1467604679
3197.5319548669
3203.91883418626
3210.30739559181
3216.69763625887
3223.08955337227
3229.48314412622
3235.87840572433
3242.27533537955
3248.67393031408
3255.07418775939
3261.47610495612
3267.87967915405
3274.28490761209
3280.69178759815
3287.10031638921
3293.51049127118
3299.92230953889
3306.33576849606
3312.75086545523
3319.16759773774
3325.58596267368
3332.00595760182
3338.42757986963
3344.85082683317
3351.27569585707
3357.70218431453
3364.13028958721
3370.56000906525
3376.99134014719
3383.42428023992
3389.85882675871
3396.29497712708
3402.73272877682
3409.17207914792
3415.61302568855
3422.05556585502
3428.49969711172
3434.94541693111
3441.39272279365
3447.84161218779
3454.29208260994
3460.74413156438
3467.19775656327
3473.65295512661
3480.10972478218
3486.56806306552
3493.0279675199
3499.48943569626
3505.95246515318
3512.41705345687
3518.8831981811
3525.35089690721
3531.820147224
3538.29094672779
3544.76329302229
3551.23718371864
3557.71261643534
3564.18958879823
3570.66809844044
3577.14814300237
3583.62972013165
3590.1128274831
3596.59746271874
3603.08362350768
3609.57130752617
3616.06051245749
3622.551235992
3629.04347582702
3635.53722966687
3642.03249522281
3648.52927021299
3655.02755236247
3661.52733940312
3668.02862907366
3674.53141911958
3681.03570729312
3687.54149135324
3694.04876906563
3700.5575382026
3707.06779654312
3713.57954187277
3720.09277198368
3726.60748467455
3733.1236777506
3739.64134902351
3746.16049631145
3752.68111743901
3759.20321023718
3765.72677254333
3772.25180220117
3778.77829706074
3785.30625497836
3791.83567381663
3798.36655144435
3804.89888573658
3811.43267457451
3817.96791584552
3824.50460744311
3831.04274726688
3837.5823332225
3844.12336322169
3850.6658351822
3857.20974702776
3863.75509668809
3870.30188209886
3876.85010120162
3883.39975194385
3889.95083227889
3896.50334016593
3903.05727356996
3909.61263046177
3916.16940881792
3922.72760662074
3929.28722185823
3935.84825252413
3942.41069661782
3948.97455214435
3955.53981711439
3962.10648954419
3968.6745674556
3975.24404887602
3981.81493183836
3988.38721438105
3994.96089454801
4001.53597038861
4008.11243995766
4014.69030131538
4021.26955252739
4027.85019166468
4034.43221680357
4041.01562602573
4047.60041741811
4054.18658907297
4060.77413908779
4067.36306556533
4073.95336661352
4080.54504034553
4087.13808487967
4093.73249833942
4100.32827885339
4106.92542455527
4113.52393358389
4120.1238040831
4126.72503420183
4133.32762209402
4139.93156591862
4146.53686383957
4153.14351402576
4159.75151465106
4166.36086389423
4172.97155993894
4179.58360097378
4186.19698519216
4192.81171079236
4199.42777597749
4206.04517895547
4212.66391793899
4219.28399114552
4225.90539679728
4232.52813312123
4239.15219834903
4245.77759071704
4252.40430846629
4259.03234984247
4265.6617130959
4272.29239648155
4278.92439825894
4285.55771669222
4292.19235005009
4298.82829660577
4305.46555463706
4312.10412242622
4318.74399826005
4325.38518042979
4332.02766723116
4338.6714569643
4345.31654793381
4351.96293844866
4358.61062682222
4365.25961137225
4371.90989042083
4378.56146229442
4385.21432532378
4391.86847784396
4398.52391819433
4405.18064471851
4411.83865576438
4418.49794968406
4425.1585248339
4431.82037957445
4438.48351227044
4445.14792129079
4451.81360500857
4458.480561801
4465.14879004942
4471.81828813927
4478.48905446012
4485.16108740558
4491.83438537335
4498.50894676516
4505.1847699868
4511.86185344804
4518.5401955627
4525.21979474854
4531.90064942733
4538.58275802478
4545.26611897055
4551.95073069822
4558.63659164529
4565.32370025315
4572.0120549671
4578.70165423628
4585.3924965137
4592.0845802562
4598.77790392447
4605.47246598299
4612.16826490005
4618.86529914772
4625.56356720184
4632.263067542
4638.96379865154
4645.66575901755
4652.36894713079
4659.07336148575
4665.77900058061
4672.48586291721
4679.19394700107
4685.90325134133
4692.61377445078
4699.32551484584
4706.03847104651
4712.75264157642
4719.46802496276
4726.18461973628
4732.9024244313
4739.62143758569
4746.34165774082
4753.06308344161
4759.78571323647
4766.50954567729
4773.23457931946
4779.96081272181
4786.68824444666
4793.41687305975
4800.14669713024
4806.87771523072
4813.60992593719
4820.34332782903
4827.077919489
4833.81369950324
4840.55066646124
4847.28881895584
4854.0281555832
4860.7686749428
4867.51037563746
4874.25325627325
4880.99731545956
4887.74255180904
4894.48896393762
4901.23655046444
4907.98531001194
4914.73524120573
4921.48634267466
4928.2386130508
4934.9920509694
4941.74665506889
4948.50242399087
4955.25935638012
4962.01745088455
4968.77670615521
4975.5371208463
4982.2986936151
4989.06142312203
4995.82530803059
5002.59034700738
5009.35653872204
5016.1238818473
5022.89237505895
5029.6620170358
5036.43280645971
5043.20474201555
5049.97782239121
5056.75204627756
5063.5274123685
5070.30391936087
5077.08156595451
5083.86035085219
5090.64027275967
5097.4213303856
5104.20352244161
5110.98684764221
5117.77130470485
5124.55689234986
5131.34360930046
5138.13145428277
5144.92042602577
5151.71052326128
5158.50174472401
5165.29408915148
5172.08755528406
5178.88214186493
5185.67784764011
5192.47467135838
5199.27261177136
5206.07166763342
5212.87183770172
5219.67312073619
5226.47551549951
5233.27902075712
5240.08363527718
5246.8893578306
5253.69618719099
5260.50412213469
5267.31316144074
5274.12330389085
5280.93454826945
5287.74689336363
5294.56033796314
5301.3748808604
5308.19052085048
5315.00725673107
5321.82508730252
5328.6440113678
5335.46402773247
5342.28513520473
5349.10733259535
5355.93061871771
5362.75499238775
5369.580452424
5376.40699764756
5383.23462688206
5390.06333895371
5396.89313269122
5403.72400692587
5410.55596049143
5417.38899222422
5424.22310096303
5431.05828554918
5437.89454482645
5444.73187764114
5451.57028284199
5458.40975928022
5465.25030580951
5472.09192128598
5478.93460456822
5485.77835451723
5492.62316999644
5499.4690498717
5506.31599301129
5513.16399828586
5520.01306456849
5526.86319073464
5533.71437566214
5540.56661823119
5547.41991732437
5554.27427182663
5561.12968062524
5567.98614260983
5574.84365667238
5581.70222170717
5588.56183661082
5595.42250028227
5602.28421162275
5609.1469695358
5616.01077292726
5622.87562070523
5629.74151178011
5636.60844506457
5643.47641947354
5650.34543392421
5657.21548733601
5664.08657863062
5670.95870673196
5677.83187056617
5684.70606906162
5691.5813011489
5698.45756576079
5705.33486183229
5712.21318830058
5719.09254410504
5725.97292818723
5732.85433949087
5739.73677696187
5746.62023954828
5753.50472620032
5760.39023587036
5767.27676751289
5774.16432008455
5781.05289254412
5787.94248385247
5794.83309297262
5801.72471886967
5808.61736051084
5815.51101686545
5822.40568690488
5829.30136960263
5836.19806393425
5843.09576887738
5849.99448341171
5856.89420651899
5863.79493718304
5870.69667438969
5877.59941712685
5884.50316438444
5891.4079151544
5898.31366843071
5905.22042320936
5912.12817848834
